language: python
dist: xenial
python:
- 3.7

before_install:
- pip install poetry

install:
- poetry install
- poetry --version

script:
# - echo Skipping tests
- poetry run tests
# - poetry run coverage run --source=my_package -m unittest discover -b

before_deploy:
- poetry config http-basic.pypi $PYPI_USER $PYPI_PASS
- poetry build

deploy:
  provider: script
  script: poetry publish
  skip_cleanup: true
  on:
    tags: true

notifications:
  email: false

env:
  global:
  # Command to generate secure variables: travis encrypt VARIABLE=VALUE --add env.global
  # As described in: https://docs.travis-ci.com/user/environment-variables/#encrypting-environment-variables
  - secure: ZhdTVLojaja3vrL+0uz85A3RAOJyFb+736V/G1tvjlVqT9h2lLtUQS3CNouHFYnpLypxXRUy7roe7wByydViJRU2e3EULrWOqT5bXNsyzERkp25P9PUZNnHdAnsQYfrvXpHMFDSVfQi/WvpLEsiAWzGnt10cnacmSYM9ke+sz6NMsdrpmyMtsOI47KBaTueqQJbhiMlDGmmm6Gg41Na5PWVza47m6nWoRAuPShujUrwVhHuep036TPu8PKiaekYCekmR0WsD4pmz/Sg6qlc6MexbNdnrB3MidSLFVlgxGcpHZuhu7lyeklhCJioVw3OKzvQkRgMU1xVWMO3ppF4cO/ptqyrRkFJa0YW9J15v9xtqiiN2ruLMGAXQNwD+r6aQ7PpS1Ge/rUkqhGoxDfXoj/TRoFdqrVHjWu4tp3Hcmm8eVKlZ7Bbfoj199z3yQ/O/ElIUXmpNsuH+405yszcVUyg3rs/KnSCSRTFxbnZONEO0csdimnt30wWUBPjR94Pv9F2dDg8B47Yb+8++zteklP9hJ1CPxBit/Nfs6vUkuzvloyKzDYmRnYHAHLpLPFFKEnycTPKGd3lO+8ebUaSqh0S/asszBXTvHVB4JapTvPwN8gjqfRfac+AYUxNdSDgcrCusEljeHBwpdfUQDEwRWBY+AjUxCr2dbZdTFYZm6Lc=
  - secure: kdQ9zUEe+EUUS3rfuADwpltRw0qF3Bx6nsbk1+XwVyaHB2p6L/BI72QeDcsQ49Dfhy2JQKlywkCsAicDKG55hZi/C30p6T6tr7Yu5/C4nIbyZSwhOoHqGgE1XTWLkvphAxUWhGYDtQRGS6IDJ6Bb2KkfsyMNX4403OjHIdTw5C1kyFI93WDeruokgM/SQLyujNA2yhrW9/jztangFW4ygg3Eesn/HtzNsPBEU2M6teQ80Z5LfdCqA16wiV193EIpYimYHaJdEAk0fIyAdirO+lZt34fVj59kas2kRd9SLTD++GJC6F3sfBTEzojiIlWbgYU99rjwHhHUdscU/4iDcApg8gcVSeY5XB0khPCsBmUnS3fFk4v7f/nVBYsD+aVC7P6/G9ibZncExwUnwc0M4bHULOcyTE0pCemuQodI+hvJJC7aGVatHJQccKWL/DOuaC2NQ3oDOQjiJEJ/k/xT+bFi8DenGIUFpeLAyR1WKiMae8SiwfWRUGvRS0EATVHGFzrQdBQJ1JGviw3do3dffZIKsRUYp0CD0D3wy3yV0fZKHMRfELWT6ETCAhu1ROlphC1GvTB94LlhqkH7LVI/BSjpdOp0o7Uvd4yD1FqGjedR5pXAYjCCQPT+2zii9fUUaZw3eR7aeyODC0LNKfx5bG5ITMSN7SstYD8Tj+h6p8g=
